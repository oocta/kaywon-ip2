<!doctype html>
<html lang="en" data-framework="jquery">
	<head>
		<meta charset="utf-8">
		<title>Interaction Programming</title>
		<link rel="stylesheet" href="./css/normalize.css">
		<link rel="stylesheet" href="./css/index.css">
	</head>
	<body>
		<section>
			<div id="imageSlider" class="imageSlider">
				<ul id="sliderContainer" class="sliderContainer">
					<!-- 슬라이더 아이템의 위치 -->
				</ul>
				<div id="controller" class="controller">
					<button id="leftButton" class="left">왼쪽으로</button>
					<button id="rightButton" class="right">오른쪽으로</button>
				</div>
				<div id="pagination" class="pagination">
					
				</div>
			</div>
		</section>

		<!-- Javascript -->
		<script type="text/javascript" src="./js/jquery.js"></script>
		<script type="text/javascript">
			//자바스크립트 코드 작성 영역
			//Step 4. 왼쪽, 오른쪽으로 무한 롤링되도록 코드를 수정합니다.
			//무한슬라이드 이동을 구현하는 방법은,
			//현재 데이터를 기준으로 보았을때 'red'-'blue'-'green' 으로 배치되어 있는
			//노드를 'green'-'red'-'blue'-'green'-'red'의 구성으로 재배치하는게 핵심입니다.
			//[0] green과 [3] green은 같은 노드로, [1] red 와 [4] red는 같은 노드로 구성합니다.
			//(clone이나 배열을 이용한 노드 생성시에 추가하셔도 무방합니다. 본 튜토리얼은 clone을 활용하는 방향으로 진행하겠습니다.)
			var colorsArray = ['red', 'blue', 'green'];
      
      $(document).ready(function () {
        
        var $sliderContainer = $('#sliderContainer');
        var maxPage = colorsArray.length; //슬라이드 컨텐츠의 길이를 정의합니다.
        var contentWidth = $sliderContainer.width(); // 슬라이드 컨텐츠 width
        var currentPage = 0; //현재페이지 변수
        var $leftButton = $('#leftButton'); // 왼쪽 버튼
        var $rightButton = $('#rightButton'); // 오른쪽 버튼
        
        $.each(colorsArray, function (idx, val) {
          var $li = $('<li/>', {'style': 'background-color:' + val});
          $sliderContainer.append($li);
        });
        
        // #1
        // 'red'-'blue'-'green' => 'green'-'red'-'blue'-'green'-'red' 으로 변경해주기 위해 clone 메서드를 이용해서 노드를 복사하고, 추가하겠습니다. $sliderContainer.children().last() 은 $sliderContainer의 자식노드 중 마지막 노드(여기는 green 배경색을 가진 노드)를 clone 메서드를 이용해서 복제하였습니다.
        var cloneLast = $sliderContainer.children().last().clone();
        var cloneFirst = $sliderContainer.children().first().clone();
        // 복사한 green 노드를 $sliderContainer의 제일 앞에 추가합니다.
        $sliderContainer.prepend(cloneLast);
        $sliderContainer.append(cloneFirst);
        //여기까지 작성하고 테스트해볼 경우 첫 슬라이드 아이템이 red가 아닌 green이 되었음을 확인할 수 있습니다.
        
        $sliderContainer.width(maxPage * contentWidth);
        
        
        $leftButton.on('click', function () {
          
          if (currentPage > 0) {
            currentPage--;
          } else {
            currentPage = 0;
          }
          
          move(currentPage, contentWidth);
        });
        
        
        $rightButton.on('click', function () {
          
          if (currentPage < maxPage - 1) {
            currentPage++;
          } else {
            currentPage = maxPage - 1;
          }
          console.log(maxPage)
          move(currentPage, contentWidth);
          
        });
        
        function move(cPage, cWidth) {
          $sliderContainer.animate({'margin-left': cPage * cWidth * -1 }, 1000);
        }
        
      });
      
		</script>
	</body>
</html>
